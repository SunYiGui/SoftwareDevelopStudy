## Start

#### æ–°å»ºspringbooté¡¹ç›®ã€å¼•å…¥å¯¹åº”çš„ä¾èµ–ï¼ˆwebã€mybatisã€mysqlé©±åŠ¨ï¼‰

åœ¨`pom.xml`æ–‡ä»¶ä¸­å¯¼å…¥å¯¹åº”ä¾èµ–ï¼š

```xml
	<dependencies>
<!--        webä¾èµ–-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>
<!--æµ‹è¯•å•å…ƒ-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
<!--		mybatisä¾èµ–-->
		<dependency>
			<groupId>org.mybatis.spring.boot</groupId>
			<artifactId>mybatis-spring-boot-starter</artifactId>
			<version>3.0.0</version>
		</dependency>
<!--		mysqlä¾èµ–-->
		<dependency>
			<groupId>com.mysql</groupId>
			<artifactId>mysql-connector-j</artifactId>

		</dependency>

	</dependencies>
```

#### é…ç½®æ–‡ä»¶application.ymlä¸­å¼•å…¥mybatisçš„é…ç½®ä¿¡æ¯

```yml
#é…ç½®mybatis
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/big_event
    username: root
    password: 123456
```

#### åˆ›å»ºåŒ…ç»“æ„ï¼Œå‡†å¤‡å®ä½“ç±»



## ç”¨æˆ·æ¨¡å—

å¼€å‘æ¨¡å—æµç¨‹ï¼š

![](../../../img/å¾®ä¿¡æˆªå›¾_20241015163355.png)



#### æ³¨å†Œ

**åŸºæœ¬ä¿¡æ¯ï¼š**

è¯·æ±‚è·¯å¾„ï¼š/user/register

è¯·æ±‚æ–¹å¼ï¼šPOST

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ³¨å†Œæ–°ç”¨æˆ·

**è¯·æ±‚å‚æ•°ï¼š**

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šx-www-form-urlencoded

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§° | è¯´æ˜   | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨           |
| -------- | ------ | ------ | -------- | -------------- |
| username | ç”¨æˆ·å | string | æ˜¯       | 5-16ä½éç©ºå­—ç¬¦ |
| password | å¯†ç    | string | æ˜¯       | 5-16ä½éç©ºå­—ç¬¦ |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```shell
username=zhangsan&password=123456
```

**å“åº”æ•°æ®ï¼š**

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
    "code":0,
    "meddage":"æ“ä½œæˆåŠŸ",
    "data":null
}
```

æ³¨å…¥åŸç†ï¼Ÿï¼Ÿ

åç«¯æµ‹è¯•ï¼špostMan

```text
406é—®é¢˜ï¼ŒNo acceptable representation

å®ä½“ç±»æ²¡æœ‰set,getæ–¹æ³•
```

##### **å‚æ•°æ ¡éªŒæ¡†æ¶ï¼š**Spring ValidationğŸ’¡

Springæä¾›ä¸€ä¸ªå‚æ•°æ ¡éªŒæ¡†æ¶ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„æ³¨è§£å®Œæˆå‚æ•°æ ¡éªŒ

###### 1ã€å¼•å…¥Spring Validataonèµ·æ­¥ä¾èµ–

```xml
<!--		validationä¾èµ–-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
		</dependency>
```

###### 2ã€åœ¨å‚æ•°å‰é¢æ·»åŠ @Patternæ³¨è§£



###### 3ã€åœ¨Controllerç±»ä¸Šæ·»åŠ @Validatedæ³¨è§£

###### 4ã€å‚æ•°æ ¡éªŒå¤±è´¥å¼‚å¸¸å¤„ç†

åœ¨å…¨å±€å¼‚å¸¸å¤„ç†å™¨ä¸­ï¼Œå¤„ç†å¼‚å¸¸è¿”å›ç»“æœ

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(Exception.class)//è¡¨æ˜å¤„ç†çš„æ˜¯Exceptionå¼‚å¸¸
    public Result handleException(final Exception e) {
        e.printStackTrace();
        return Result.error(StringUtils.hasLength(e.getMessage())?e.getMessage():"æ“ä½œå¤±è´¥" );
    }
}
```

`@RestControllerAdvice`æ˜¯ Spring æ¡†æ¶ä¸­çš„ä¸€ä¸ªæ³¨è§£ï¼Œç”¨äºå®šä¹‰å…¨å±€çš„å¼‚å¸¸å¤„ç†ã€ç»Ÿä¸€çš„å“åº”å¤„ç†ç­‰åŠŸèƒ½ã€‚

#### ç™»å½•

##### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/user/login

è¯·æ±‚æ–¹å¼ï¼šPOST

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºç™»å½•

##### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šx-www-form-urlencoded

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§° | è¯´æ˜   | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨           |
| -------- | ------ | ------ | -------- | -------------- |
| username | ç”¨æˆ·å | String | æ˜¯       | 5-16ä½éç©ºå­—ç¬¦ |
| password | å¯†ç    |        | Stringæ˜¯ | 5-16ä½éç©ºå­—ç¬¦ |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```shell
username=zhangsan&password=123456
```

##### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | string | å¿…é¡»     |        | è¿”å›çš„æ•°æ®ï¼Œjwtä»¤ç‰Œ    |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0
"message":â€œæ“ä½œæˆåŠŸ"
"data":
"eyhtGci0JIUzIINISInR5cCI6IkpXVc9.eyJjbGFpbXMionsiawQiojUsInVz2XJuYW11Tjoid2FuZ2JhInOSIMV4CCI6MTYSMZCXNTK30HO,PE_RATCOF7NMSKED9eC3CZCBbKWAFOLOISUMNinZ95M"
}
```

##### å¤‡æ³¨

ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä¸‹å‘JWTä»¤ç‰Œï¼Œç„¶åå†åç»­çš„æ¯æ¬¡è¯·æ±‚ä¸­ï¼Œæµè§ˆå™¨éƒ½éœ€è¦å†è¯·æ±‚å¤´headerä¸­æºå¸¦åˆ°æœåŠ¡ç«¯ï¼Œè¯·æ±‚å¤´çš„åç§°ä½Authorizationï¼Œå€¼ä¸ºç™»å½•æ—¶ä¸‹å‘çš„JWTä»¤ç‰Œã€‚

å¦‚æœæ£€æµ‹åˆ°ç”¨æˆ·æœªç™»å½•ï¼Œåˆ™httpå“åº”çŠ¶æ€ç ä¸º401

##### ç™»å½•è®¤è¯ï¼ˆJWTï¼‰ğŸ”

ä»¤ç‰Œå°±æ˜¯ä¸€æ®µå­—ç¬¦ä¸²

æ‰¿è½½ä¸šåŠ¡æ•°æ®ï¼Œå‡å°‘åäºè¯·æ±‚æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°

é˜²ç¯¡æ”¹ï¼Œä¿è¯ä¿¡æ¯çš„åˆæ³•å’Œæœ‰æ•ˆæ€§

**JWT çš„ç»“æ„**

JWT ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«ç”¨å¥å·ï¼ˆ.ï¼‰åˆ†éš”ï¼š

1. å¤´éƒ¨ï¼ˆHeaderï¼‰ï¼šé€šå¸¸åŒ…å«ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼Œä»¤ç‰Œçš„ç±»å‹ï¼ˆå³ â€œJWTâ€ï¼‰å’Œä½¿ç”¨çš„å“ˆå¸Œç®—æ³•ï¼ˆå¦‚ HMAC SHA256 æˆ– RSAï¼‰ã€‚ä¾‹å¦‚ï¼š`{ "alg": "HS256", "typ": "JWT" }`ã€‚è¿™ä¸ªéƒ¨åˆ†ä¼šè¢« Base64Url ç¼–ç ã€‚
2. è½½è·ï¼ˆPayloadï¼‰ï¼šåŒ…å«å£°æ˜ï¼ˆclaimsï¼‰ï¼Œå£°æ˜æ˜¯å…³äºå®ä½“ï¼ˆé€šå¸¸ä¸ºç”¨æˆ·ï¼‰å’Œå…¶ä»–é¢å¤–æ•°æ®çš„å£°æ˜ã€‚å£°æ˜åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼šæ³¨å†Œå£°æ˜ã€å…¬å¼€å£°æ˜å’Œç§æœ‰å£°æ˜ã€‚ä¾‹å¦‚ï¼š`{ "sub": "1234567890", "name": "John Doe", "iat": 1516239022 }`ã€‚è¿™ä¸ªéƒ¨åˆ†ä¹Ÿä¼šè¢« Base64Url ç¼–ç ã€‚
3. ç­¾åï¼ˆSignatureï¼‰ï¼šå¯¹å¤´éƒ¨å’Œè½½è·è¿›è¡Œç­¾åï¼Œä»¥ç¡®ä¿ä»¤ç‰Œåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚ç­¾åæ˜¯ä½¿ç”¨æŒ‡å®šçš„å“ˆå¸Œç®—æ³•å’Œä¸€ä¸ªå¯†é’¥è®¡ç®—å¾—å‡ºçš„ã€‚ä¾‹å¦‚ï¼š`HMACSHA256(base64UrlEncode(header) + "." + base64UrlEncode(payload), secret)`ã€‚

**å·¥ä½œåŸç†**

1. ç”¨æˆ·ç™»å½•ï¼šå½“ç”¨æˆ·æˆåŠŸç™»å½•ç³»ç»Ÿæ—¶ï¼ŒæœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ª JWTï¼Œå¹¶å°†å…¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚
2. å®¢æˆ·ç«¯å­˜å‚¨ï¼šå®¢æˆ·ç«¯é€šå¸¸ä¼šå°† JWT å­˜å‚¨åœ¨æœ¬åœ°å­˜å‚¨ï¼ˆå¦‚æµè§ˆå™¨çš„ localStorageï¼‰æˆ– Cookie ä¸­ã€‚
3. è¯·æ±‚æˆæƒèµ„æºï¼šåœ¨åç»­çš„è¯·æ±‚ä¸­ï¼Œå®¢æˆ·ç«¯ä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ JWTï¼Œé€šå¸¸ä½¿ç”¨ â€œAuthorizationâ€ å¤´ï¼Œæ ¼å¼ä¸º â€œBearer <token>â€ã€‚
4. æœåŠ¡å™¨éªŒè¯ï¼šæœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šéªŒè¯ JWT çš„æœ‰æ•ˆæ€§ã€‚å¦‚æœ JWT æœ‰æ•ˆï¼ŒæœåŠ¡å™¨ä¼šæˆæƒè®¿é—®è¯·æ±‚çš„èµ„æºï¼›å¦‚æœ JWT æ— æ•ˆï¼ŒæœåŠ¡å™¨ä¼šè¿”å›é”™è¯¯å“åº”ã€‚

**ä¼˜åŠ¿**

1. æ— çŠ¶æ€ï¼šæœåŠ¡å™¨ä¸éœ€è¦å­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼Œå› ä¸ºæ‰€æœ‰çš„å¿…è¦ä¿¡æ¯éƒ½åŒ…å«åœ¨ JWT ä¸­ã€‚è¿™ä½¿å¾—æœåŠ¡å™¨å¯ä»¥è½»æ¾åœ°æ‰©å±•å’Œå¤„ç†å¤§é‡çš„å¹¶å‘è¯·æ±‚ã€‚
2. å®‰å…¨æ€§ï¼šJWT å¯ä»¥ä½¿ç”¨æ•°å­—ç­¾åæ¥ç¡®ä¿å®Œæ•´æ€§å’ŒçœŸå®æ€§ã€‚åªæœ‰æ‹¥æœ‰æ­£ç¡®å¯†é’¥çš„æœåŠ¡å™¨æ‰èƒ½ç”Ÿæˆå’ŒéªŒè¯ JWTã€‚
3. è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰ï¼šç”±äº JWT æ˜¯é€šè¿‡è¯·æ±‚å¤´ä¼ é€’çš„ï¼Œå®ƒå¯ä»¥åœ¨ä¸åŒåŸŸä¹‹é—´çš„è¯·æ±‚ä¸­ä½¿ç”¨ï¼Œè€Œä¸éœ€è¦å¤„ç†å¤æ‚çš„ CORS é…ç½®ã€‚
4. çµæ´»æ€§ï¼šå¯ä»¥åœ¨ JWT çš„è½½è·ä¸­åŒ…å«å„ç§è‡ªå®šä¹‰çš„å£°æ˜ï¼Œä»¥æ»¡è¶³ä¸åŒçš„åº”ç”¨éœ€æ±‚ã€‚

**JWTä½¿ç”¨**

#### æ‹¦æˆªå™¨ğŸ”

*åœ¨æ¯ä¸ªè¯·æ±‚ä¸­éƒ½æ·»åŠ JwtéªŒè¯æ— ç–‘å¤ªç¹çï¼Œæ‰€ä»¥åº”è¯¥æ·»åŠ æ‹¦æˆªå™¨ï¼Œåœ¨æ‹¦æˆªå™¨ä¸­è®¾ç½®JWT*

#### è·å–ç”¨æˆ·è¯¦ç»†ä¿¡æ¯

##### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/user/userInfo

è¯·æ±‚æ–¹å¼ï¼šGET

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºè·å–å½“å‰å·²ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯

##### è¯·æ±‚å‚æ•°

æ— 

##### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°          | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------------- | ------ | -------- | ------ | ---------------------- | -------- |
| code          | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message       | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data          | object | å¿…é¡»     |        | è¿”å›çš„æ•°æ®             |          |
| \|-id         | number | éå¿…é¡»   |        | ä¸»é”®ID                 |          |
| \|-username   | string | éå¿…é¡»   |        | ç”¨æˆ·å                 |          |
| \|-nickname   | string | éå¿…é¡»   |        | æ˜µç§°                   |          |
| \|-email      | string | éå¿…é¡»   |        | é‚®ç®±                   |          |
| \|-userPic    | string | éå¿…é¡»   |        | å¤´åƒåœ°å€               |          |
| \|-createTime | string | éå¿…é¡»   |        | åˆ›å»ºæ—¶é—´               |          |
| \|-updateTime | string | éå¿…é¡»   |        | æ›´æ–°æ—¶é—´               |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0
"message":â€œæ“ä½œæˆåŠŸ"
"data":{
    "id": 5,
	"usernane": "'wangba",
    "nicknane":"",
	"email":"â€,
	"userPic" :"",
	"createTime":"2023-09-02 22:21:31",
    "updateTime":"2023-09-02 22:21:31'
	}
}
```

##### 

æ³¨æ„ï¼šåœ¨å‰ç«¯å“åº”æ•°æ®ä¸­ï¼Œpasswordåº”è¯¥ä¸ä¼ å…¥

è§£å†³æ–¹æ³•ï¼š

åœ¨Userç±»ä¸­ï¼Œpasswordå±æ€§æ·»åŠ `@JsonIgnore`æ³¨è§£

```java
    @JsonIgnore
    private String password;
```



```yml
mybatis:
  configuration:
    map-underscore-to-camel-case: true
```



#### æ›´æ–°ç”¨æˆ·åŸºæœ¬ä¿¡æ¯

##### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/user/update

è¯·æ±‚æ–¹å¼ï¼šPUT

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ›´æ–°å·²ç™»å½•ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼ˆé™¤å¤´åƒå’Œå¯†ç ï¼‰

##### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šapplication/json

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§° | è¯´æ˜   | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨           |
| -------- | ------ | ------ | -------- | -------------- |
| id       | ä¸»é”®ID | number | æ˜¯       |                |
| username | ç”¨æˆ·å | String | å¦       | 5-16ä½éç©ºå­—ç¬¦ |
| nickname | æ˜µç§°   | String | æ˜¯       | 1-10ä½éç©ºå­—ç¬¦ |
| email    | é‚®ç®±   | string | æ˜¯       | æ»¡è¶³é‚®ç®±çš„æ ¼å¼ |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
{
    "id": 5,
	"usernane": "'wangba",
    "nicknane":"wb",
	"email":"wb@123.comâ€
	}
```

##### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":null
}
```

##### å‚æ•°æ ¡éªŒ

å®ä½“ç±»ä¸­å±æ€§è¿›è¡Œå‚æ•°æ ¡éªŒ

å¯¼å…¥`spring-boot-starter-validation`åŒ…

åœ¨å®ä½“ç±»ä¸­æ·»åŠ ä»¥ä¸‹æ³¨è§£ï¼š

```java
@NotNull
private Integer id;
private String username;
@JsonIgnore
private String password;
@NotEmpty
@Pattern(regexp = "^\\S{1,10}$")
private String nickname;
@NotEmpty
@Email
private String email;
```

åœ¨æ–¹æ³•å‚æ•°å‰æ·»åŠ `@Validated`æ³¨è§£ï¼š

```java
    @PutMapping("/update")
    public Result update(@RequestBody @Validated User user) {
        userService.update(user);

        return Result.success();
    }
```

#### æ›´æ–°ç”¨æˆ·å¤´åƒ

##### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/user/updateAvatar

è¯·æ±‚æ–¹å¼ï¼šPATCH

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ›´æ–°å·²ç™»å½•ç”¨æˆ·çš„å¤´åƒ

##### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šqueryString

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§°  | è¯´æ˜     | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨    |
| --------- | -------- | ------ | -------- | ------- |
| avatarUrl | å¤´åƒåœ°å€ | string | æ˜¯       | urlåœ°å€ |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
 avatarUrl= 
https://image.baidu.com/search/detail.png
```

##### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":null
}
```

##### å‚æ•°æ ¡éªŒ

`@URL`æ³¨è§£

```java
    @PatchMapping("/updateAvatar")
    public Result updateAvatar(@RequestParam @URL String avatarUrl){
        userService.updateAvatar(avatarUrl);
        return Result.success();
    }
```

#### æ›´æ–°ç”¨æˆ·å¯†ç 

##### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/user/updatePwd

è¯·æ±‚æ–¹å¼ï¼šPATCH

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ›´æ–°å·²ç™»å½•ç”¨æˆ·çš„å¯†ç 

##### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šapplication/json

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§° | è¯´æ˜       | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨ |
| -------- | ---------- | ------ | -------- | ---- |
| old_pwd  | åŸå¯†ç      | string | æ˜¯       |      |
| new_pwd  | æ–°å¯†ç      | string | æ˜¯       |      |
| re_pwd   | ç¡®è®¤æ–°å¯†ç  | string | æ˜¯       |      |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
{ 
	"old_pwd":"123456",
    "new_pwd":"234567",
    "re_pwd":"234567"
}
```

##### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":null
}
```

##### å‚æ•°æ ¡éªŒ

## æ–‡ç« åˆ†ç±»

### æ–°å¢æ–‡ç« åˆ†ç±»

#### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/category

è¯·æ±‚æ–¹å¼ï¼šPOST

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ–°å¢æ–‡ç« åˆ†ç±»

#### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šapplication/json

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§°      | è¯´æ˜     | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨ |
| ------------- | -------- | ------ | -------- | ---- |
| categoryName  | åˆ†ç±»åç§° | string | æ˜¯       |      |
| categoryAlias | åˆ†ç±»åˆ«å | string | æ˜¯       |      |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
{ 
	"categoryName":"äººæ–‡",
    "categoryAlias":"rw"
}
```

#### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":null
}
```

### æ–‡ç« åˆ†ç±»åˆ—è¡¨

#### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/category

è¯·æ±‚æ–¹å¼ï¼šGET

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºè·å–å½“å‰å·²ç™»å½•ç”¨æˆ·åˆ›å»ºçš„æ‰€æœ‰æ–‡ç« åˆ†ç±»

#### è¯·æ±‚å‚æ•°

æ— ã€

#### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°             | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ---------------- | ------ | -------- | ------ | ---------------------- | -------- |
| code             | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message          | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data             | object | å¿…é¡»     |        | è¿”å›çš„æ•°æ®             |          |
| \|-id            | number | éå¿…é¡»   |        | ä¸»é”®ID                 |          |
| \|-categoryName  | string | éå¿…é¡»   |        | åˆ†ç±»åç§°               |          |
| \|-categoryAlias | string | éå¿…é¡»   |        | åˆ†ç±»åˆ«å               |          |
| \|-createTime    | string | éå¿…é¡»   |        | åˆ›å»ºæ—¶é—´               |          |
| \|-updateTime    | string | éå¿…é¡»   |        | ä¿®æ”¹æ—¶é—´               |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":[
	{
        "id":3,
		"categoryName":"ç¾é£Ÿ",
		"categoryAlias":"my",
		"createTime":"2023-09-02 12:06:59",
        "updateTime":"2023-09-02 12:06:59"
    },
	{
    	"id":4,
    	"categoryName":"å¨±ä¹",
        "categoryAlias":"yl",
        "createTime":"2023-09-02 12:08:16",
        "updateTime":"2023-09-02 12:08:16"
    },
	{
        "id":5,
		"categoryName":"å†›äº‹",
		"categoryAlias":"js",
        "createTime":"2023-09-02 12:08:33",
        "updateTime":"2023-09-02 12:08:33"
    }
   ]
}
```

#### å…¶ä»–

åˆ©ç”¨`@JsonFormat`æ³¨è§£ï¼Œæ”¹å˜æ—¶é—´æ ¼å¼

```java
 @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    private LocalDateTime createDateTime;
    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
    private LocalDateTime updateDateTime;
```

### è·å–æ–‡ç« åˆ†ç±»è¯¦æƒ…

#### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/category/detail

è¯·æ±‚æ–¹å¼ï¼šGET

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ ¹æ®IDè·å–æ–‡ç« åˆ†ç±»è¯¦æƒ…

#### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šqueryString

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§° | è¯´æ˜   | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨ |
| -------- | ------ | ------ | -------- | ---- |
| id       | ä¸»é”®ID | number | æ˜¯       |      |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
{ 
	id=3
}
```

#### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°             | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ---------------- | ------ | -------- | ------ | ---------------------- | -------- |
| code             | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message          | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data             | object | å¿…é¡»     |        | è¿”å›çš„æ•°æ®             |          |
| \|-id            | number | éå¿…é¡»   |        | ä¸»é”®ID                 |          |
| \|-categoryName  | string | éå¿…é¡»   |        | åˆ†ç±»åç§°               |          |
| \|-categoryAlias | string | éå¿…é¡»   |        | åˆ†ç±»åˆ«å               |          |
| \|-createTime    | string | éå¿…é¡»   |        | åˆ›å»ºæ—¶é—´               |          |
| \|-updateTime    | string | éå¿…é¡»   |        | ä¿®æ”¹æ—¶é—´               |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":	{
        "id":3,
		"categoryName":"ç¾é£Ÿ",
		"categoryAlias":"ms",
		"createTime":"2023-09-02 12:06:59",
        "updateTime":"2023-09-02 12:06:59"
    }
}
```

### æ›´æ–°æ–‡ç« åˆ†ç±»

#### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/category

è¯·æ±‚æ–¹å¼ï¼šPUT

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ›´æ–°æ–‡ç« åˆ†ç±»

#### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šapplication/json

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§°      | è¯´æ˜     | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨ |
| ------------- | -------- | ------ | -------- | ---- |
| id            | ä¸»é”®ID   | number | æ˜¯       |      |
| categoryName  | åˆ†ç±»åç§° | string | æ˜¯       |      |
| categoryAlias | åˆ†ç±»åˆ«å | string | æ˜¯       |      |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
{ 
    "id":6,
	"categoryName":"äººæ–‡",
    "categoryAlias":"rw"
}
```

#### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":null
}
```

#### åˆ†ç»„æ ¡éªŒ

æŠŠæ ¡éªŒé¡¹è¿›è¡Œå½’ç±»åˆ†ç»„ï¼Œåœ¨å®Œæˆä¸åŒçš„åŠŸèƒ½çš„æ—¶å€™ï¼Œæ£€éªŒæŒ‡å®šç»„ä¸­çš„æ ¡éªŒé¡¹

##### å®šä¹‰åˆ†ç»„

åœ¨å®ä½“ç±»ä¸­å®šä¹‰ä¸¤ä¸ªæ¥å£ï¼Œä½œä¸ºä¸¤ä¸ªåˆ†ç»„

```java
public class Category{
    
    
    public interface Add{
        
    }
    
    public interface Update{
        
    }
}
```

##### å®šä¹‰æ ¡éªŒé¡¹æ—¶æŒ‡å®šå½’å±çš„åˆ†ç»„

åœ¨å®ä½“ç±»ä¸­å±æ€§å®šä¹‰

```java
    @NotNull(groups = Update.class)
    private Integer id;
    @NotEmpty(groups = {Update.class,Add.class}) //@NotNull + !""
    private String categoryName;
    @NotEmpty(groups = {Update.class,Add.class})
    private String categoryAlias;
```



##### æ ¡éªŒæ—¶æŒ‡å®šè¦æ ¡éªŒçš„åˆ†ç»„

Controllerå±‚æŒ‡å®šåˆ†ç»„

```java
@PostMapping
public Result add(@RequestBody @Validated(Category.Add.class) Category category) {
    categoryService.add(category);
    return Result.success();
}

@PutMapping
public Result update(@RequestBody @Validated(Category.Update.class) Category category) {
    categoryService.update(category);
    return Result.success();
}
```

æ³¨æ„ï¼š

å¦‚æœæŸä¸ªæ ¡éªŒé¡¹æ²¡æœ‰æŒ‡å®šåˆ†ç»„ï¼Œé»˜è®¤å±äºDefaultåˆ†ç»„

åˆ†ç»„ä¹‹é—´å¯ä»¥ç»§æ‰¿ï¼ŒA extends B é‚£ä¹ˆAä¸­æ‹¥æœ‰Bä¸­æ‰€æœ‰çš„æ ¡éªŒé¡¹

### åˆ é™¤æ–‡ç« åˆ†ç±»

#### åŸºæœ¬ä¿¡æ¯

è¯·æ±‚è·¯å¾„ï¼š/category

è¯·æ±‚æ–¹å¼ï¼šPUT

æ¥å£æè¿°ï¼šè¯¥æ¥å£ç”¨äºæ›´æ–°æ–‡ç« åˆ†ç±»

#### è¯·æ±‚å‚æ•°

è¯·æ±‚å‚æ•°æ ¼å¼ï¼šapplication/json

è¯·æ±‚å‚æ•°è¯´æ˜ï¼š

| å‚æ•°åç§°      | è¯´æ˜     | ç±»å‹   | æ˜¯å¦å¿…é¡» | å¤‡æ³¨ |
| ------------- | -------- | ------ | -------- | ---- |
| id            | ä¸»é”®ID   | number | æ˜¯       |      |
| categoryName  | åˆ†ç±»åç§° | string | æ˜¯       |      |
| categoryAlias | åˆ†ç±»åˆ«å | string | æ˜¯       |      |

è¯·æ±‚æ•°æ®æ ·ä¾‹ï¼š

```json
{ 
    "id":6,
	"categoryName":"äººæ–‡",
    "categoryAlias":"rw"
}
```

#### å“åº”æ•°æ®

å“åº”æ•°æ®ç±»å‹ï¼šapplication/json

å“åº”å‚æ•°è¯´æ˜ï¼š

| åç§°    | ç±»å‹   | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨                   | å…¶ä»–ä¿¡æ¯ |
| ------- | ------ | -------- | ------ | ---------------------- | -------- |
| code    | number | å¿…é¡»     |        | å“åº”ç ï¼Œ0-æˆåŠŸï¼Œ1-å¤±è´¥ |          |
| message | string | éå¿…é¡»   |        | æç¤ºä¿¡æ¯               |          |
| data    | object | éå¿…é¡»   |        | è¿”å›çš„æ•°æ®             |          |

å“åº”æ•°æ®æ ·ä¾‹ï¼š

```json
{
"code":0,
"message":"æ“ä½œæˆåŠŸ",
"data":null
}
```

